<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>متجر الألعاب - ASK ME FIRST</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* Custom Styles & Overrides */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f7fafc; /* Light mode background */
            color: #2d3748; /* Light mode text */
            direction: rtl; /* Ensure Right-to-Left for Arabic */
        }

        body.dark-mode {
            background-color: #1a202c; /* Dark mode background */
            color: #cbd5e0; /* Dark mode text */
        }

        .dark .bg-white {
            background-color: #2d3748;
        }

        .dark .text-gray-800 {
            color: #cbd5e0;
        }

        .dark .text-gray-600 {
            color: #a0aec0;
        }

        .dark .border-gray-200 {
            border-color: #4a5568;
        }

        .dark .shadow-md {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.15);
        }

        /* Navigation Bar Styles */
        .main-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background-color: #fff; /* Light mode background */
            border-bottom: 1px solid #e2e8f0; /* Light mode border */
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            min-height: 70px; /* Ensure a minimum height */
        }

        .dark .main-nav {
            background-color: #1a202c; /* Dark mode background */
            border-bottom-color: #2d3748; /* Dark mode border */
            color: #cbd5e0;
        }

        .nav-left, .nav-right, .nav-center {
            display: flex;
            align-items: center;
        }

        .nav-center {
            flex-grow: 1;
            justify-content: center;
        }

        .navbar-brand {
            font-size: 1.8rem;
            font-weight: bold;
            color: #4a5568; /* Light mode text color */
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .dark .navbar-brand {
            color: #a0aec0; /* Dark mode text color */
        }

        .navbar-brand:hover {
            color: #63b3ed;
        }

        .nav-link {
            font-size: 1rem;
            color: #4a5568; /* Light mode text color */
            text-decoration: none;
            padding: 0.5rem 1rem;
            transition: color 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap; /* Prevent text wrapping */
        }

        .dark .nav-link {
            color: #cbd5e0; /* Dark mode text color */
        }

        .nav-link:hover {
            color: #63b3ed;
        }

        .mode-toggle-button {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #4a5568; /* Light mode icon color */
            margin-left: 1rem; /* Adjusted for RTL */
            transition: color 0.3s ease, transform 0.3s ease;
        }

        .dark .mode-toggle-button {
            color: #cbd5e0; /* Dark mode icon color */
        }

        .mode-toggle-button:hover {
            color: #63b3ed;
        }

        .mode-toggle-button.spin i {
            animation: spin 0.6s ease-in-out;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Hero Section */
        .hero-section {
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://via.placeholder.com/1500x500/000000/FFFFFF?text=Gaming+Setup'); /* Placeholder image */
            background-size: cover;
            background-position: center;
            color: white;
            padding: 6rem 1rem;
            text-align: center;
        }

        .hero-section h1 {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .hero-section p {
            font-size: 1.25rem;
            margin-bottom: 2rem;
        }

        /* Collapsible Sections */
        .collapsible-wrapper {
            margin-bottom: 1.5rem;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .dark .collapsible-wrapper {
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .collapsible-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            background-color: #edf2f7; /* Light mode header background */
            cursor: pointer;
            border-bottom: 1px solid #e2e8f0;
            transition: background-color 0.3s ease;
        }

        .dark .collapsible-header {
            background-color: #2d3748; /* Dark mode header background */
            border-bottom-color: #4a5568;
            color: #cbd5e0;
        }

        .collapsible-header:hover {
            background-color: #e2e8f0;
        }

        .dark .collapsible-header:hover {
            background-color: #4a5568;
        }

        .collapsible-header h2 {
            font-size: 1.75rem;
            font-weight: 600;
            color: #2d3748; /* Light mode text */
            margin-bottom: 0;
        }

        .dark .collapsible-header h2 {
            color: #cbd5e0; /* Dark mode text */
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.7s ease-out, padding 0.5s ease-out;
            background-color: #fff; /* Light mode content background */
            padding: 0 1.5rem; /* Initial padding */
        }

        .dark .collapsible-content {
            background-color: #1a202c; /* Dark mode content background */
        }

        .collapsible-content.show {
            max-height: 2000px; /* Adjust as needed for content height */
            padding: 1.5rem; /* Final padding when open */
        }

        /* Product Cards */
        .product-card {
            background-color: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1.5rem;
            text-align: right; /* RTL support */
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .dark .product-card {
            background-color: #2d3748;
            border-color: #4a5568;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .dark .product-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .product-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 0.5rem;
        }

        .dark .product-title {
            color: #cbd5e0;
        }

        .product-details {
            font-size: 0.9rem;
            color: #4a5568;
            margin-bottom: 1rem;
            flex-grow: 1; /* Allow details to take available space */
        }

        .dark .product-details {
            color: #a0aec0;
        }

        .product-price {
            font-size: 1.1rem;
            font-weight: bold;
            color: #38a169; /* Green price color */
            margin-bottom: 1rem;
        }

        .dark .product-price {
            color: #68d391;
        }

        .rating {
            color: #f6e05e; /* Yellow stars */
            margin-bottom: 1rem;
        }

        .details-button {
            background-color: #4299e1;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem;
            text-align: center;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }

        .details-button:hover {
            background-color: #3182ce;
        }

        /* Filter Section */
        .filter-section {
            display: flex;
            gap: 1rem;
            justify-content: flex-start; /* Align to start for RTL */
            margin-bottom: 1.5rem;
            padding: 1rem;
            background-color: #edf2f7; /* Light mode background */
            border-radius: 0.5rem;
        }

        .dark .filter-section {
            background-color: #2d3748; /* Dark mode background */
        }

        .filter-section input {
            padding: 0.5rem 1rem;
            border: 1px solid #cbd5e0;
            border-radius: 0.25rem;
            width: 120px;
            text-align: right; /* RTL input */
            background-color: #fff;
            color: #2d3748;
        }

        .dark .filter-section input {
            background-color: #1a202c;
            border-color: #4a5568;
            color: #cbd5e0;
        }

        .filter-section button {
            background-color: #4299e1;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }

        .filter-section button:hover {
            background-color: #3182ce;
        }

        /* Search Section */
        .search-section {
            padding: 2rem 1rem;
            background-color: #f0f4f8; /* Light mode background */
            border-radius: 0.5rem;
            margin-top: 2rem;
            text-align: center;
        }

        .dark .search-section {
            background-color: #2d3748; /* Dark mode background */
        }

        .search-section input {
            width: 70%;
            padding: 0.75rem 1.25rem;
            border: 1px solid #cbd5e0;
            border-radius: 0.375rem;
            margin-bottom: 1rem;
            background-color: #fff;
            color: #2d3748;
            text-align: right; /* RTL input */
        }

        .dark .search-section input {
            background-color: #1a202c;
            border-color: #4a5568;
            color: #cbd5e0;
        }

        .search-section button {
            background-color: #48bb78; /* Green button */
            color: white;
            padding: 0.75rem 2rem;
            border-radius: 0.375rem;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }

        .search-section button:hover {
            background-color: #38a169;
        }

        /* Ask Me Section */
        .ask-me-section {
            background-color: #f0f4f8;
            border-radius: 0.5rem;
            padding: 2rem;
            margin-top: 2rem;
            text-align: center;
        }

        .dark .ask-me-section {
            background-color: #2d3748;
        }

        .ask-me-section input {
            width: 80%;
            padding: 0.75rem 1.25rem;
            border: 1px solid #cbd5e0;
            border-radius: 0.375rem;
            margin-bottom: 1rem;
            background-color: #fff;
            color: #2d3748;
            text-align: right;
        }

        .dark .ask-me-section input {
            background-color: #1a202c;
            border-color: #4a5568;
            color: #cbd5e0;
        }

        .ask-me-section button {
            background-color: #9f7aea; /* Purple button */
            color: white;
            padding: 0.75rem 2rem;
            border-radius: 0.375rem;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }

        .ask-me-section button:hover {
            background-color: #805ad5;
        }

        #ask-me-answer {
            background-color: #e2e8f0;
            border-left: 5px solid #9f7aea;
            padding: 1rem;
            margin-top: 1.5rem;
            border-radius: 0.375rem;
            text-align: right;
            font-size: 1rem;
            color: #2d3748;
            word-wrap: break-word; /* Ensure long answers wrap */
        }

        .dark #ask-me-answer {
            background-color: #4a5568;
            border-left-color: #805ad5;
            color: #cbd5e0;
        }

        /* Responsive Product Grid */
        @media (max-width: 768px) {
            .product-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }
        }

        @media (max-width: 640px) {
            .product-grid {
                grid-template-columns: 1fr;
            }

            .filter-section {
                flex-direction: column;
                align-items: center;
            }

            .filter-section input, .filter-section button {
                width: 80%;
                margin-bottom: 0.5rem;
            }

            .search-section input, .ask-me-section input {
                width: 95%;
            }

            .hero-section h1 {
                font-size: 2.25rem;
            }
            .hero-section p {
                font-size: 1rem;
            }
        }

        /* Responsive adjustments for Navigation Bar (Already defined above, keeping for context) */
        @media (max-width: 768px) {
            .main-nav {
                flex-direction: column;
                padding: 1rem;
            }

            .nav-left, .nav-right, .nav-center {
                width: 100%;
                justify-content: center;
                margin-bottom: 0.5rem;
            }

            .nav-left {
                order: 2; /* Put mode toggle and request build below brand */
                margin-top: 1rem;
            }

            .nav-right {
                order: 3; /* Put favorites below request build */
            }

            .nav-center {
                order: 1; /* Keep brand at the top */
                margin-bottom: 1rem;
            }

            .mode-toggle-button {
                margin-left: 0.5rem; /* Adjusted for RTL */
                margin-right: 0.5rem;
            }

            .nav-link {
                padding: 0.5rem 0.75rem;
                font-size: 0.9rem;
            }
            .navbar-brand {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <nav class="main-nav">
        <div class="nav-left">
            <button id="mode-toggle" class="mode-toggle-button" aria-label="Toggle dark/light mode">
                <i class="fas fa-sun"></i>
            </button>
            <a href="#request-build" class="nav-link">طلب تجميعة</a>
        </div>
        <div class="nav-center">
            <a href="#" class="navbar-brand">ASK ME FIRST</a>
        </div>
        <div class="nav-right">
            <a href="#favorites-section" class="nav-link">
                <i class="fas fa-star"></i> المفضلة
            </a>
        </div>
    </nav>

    <section class="hero-section">
        <div class="container mx-auto px-4">
            <h1>اكتشف أقوى مكونات الكمبيوتر لتجربة لعب لا مثيل لها</h1>
            <p>سواء كنت تبحث عن أحدث كروت الشاشة، أقوى المعالجات، أو شاشات الألعاب فائقة السرعة، لدينا كل ما تحتاجه لبناء جهاز أحلامك.</p>
            <a href="#products" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-full text-lg transition duration-300">
                استعرض المنتجات
            </a>
        </div>
    </section>

    <section id="search" class="search-section container mx-auto my-8">
        <h2 class="text-3xl font-bold mb-6 text-gray-800 dark:text-gray-100">ابحث عن منتجك</h2>
        <div class="flex flex-col items-center">
            <input type="text" id="product-search-input" placeholder="اكتب اسم المنتج، تفاصيله، أو أي كلمة بحث..." class="mb-4">
            <button onclick="searchProducts()" class="px-8 py-3 rounded-md">بحث</button>
        </div>
    </section>

    <section id="ask-me" class="ask-me-section container mx-auto my-8">
        <h2 class="text-3xl font-bold mb-6 text-gray-800 dark:text-gray-100">اسألني أي سؤال عن قطع الكمبيوتر!</h2>
        <div class="flex flex-col items-center">
            <input type="text" id="ask-me-input" placeholder="مثال: ما هي أفضل كروت الشاشة للألعاب؟">
            <button onclick="submitQuestion()" class="px-8 py-3 rounded-md">اسأل</button>
            <div id="ask-me-answer" class="hidden mt-4 w-full md:w-3/4"></div>
        </div>
    </section>

    <section id="products" class="container mx-auto py-8 px-4">
        <h2 class="text-4xl font-bold text-center mb-10 text-gray-800 dark:text-gray-100">منتجاتنا</h2>

        <div class="collapsible-wrapper">
            <div class="collapsible-header" onclick="toggleSection('gpu-products-container', this)">
                <h2>كروت الشاشة (GPUs)</h2>
                <i class="fas fa-chevron-down text-xl"></i>
            </div>
            <div id="gpu-products-container" class="collapsible-content">
                <div class="filter-section">
                    <label for="gpu-min-price">الحد الأدنى للسعر:</label>
                    <input type="number" id="gpu-min-price" placeholder="مثال: 1000">
                    <label for="gpu-max-price">الحد الأقصى للسعر:</label>
                    <input type="number" id="gpu-max-price" placeholder="مثال: 10000">
                    <button onclick="filterProductsBySection('gpu')">تصفية</button>
                </div>
                <div id="gpu-products" class="product-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    </div>
            </div>
        </div>

        <div class="collapsible-wrapper">
            <div class="collapsible-header" onclick="toggleSection('processor-products-container', this)">
                <h2>المعالجات (Processors)</h2>
                <i class="fas fa-chevron-down text-xl"></i>
            </div>
            <div id="processor-products-container" class="collapsible-content">
                <div class="filter-section">
                    <label for="processor-min-price">الحد الأدنى للسعر:</label>
                    <input type="number" id="processor-min-price" placeholder="مثال: 1000">
                    <label for="processor-max-price">الحد الأقصى للسعر:</label>
                    <input type="number" id="processor-max-price" placeholder="مثال: 10000">
                    <button onclick="filterProductsBySection('processor')">تصفية</button>
                </div>
                <div id="processor-products" class="product-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    </div>
            </div>
        </div>

        <div class="collapsible-wrapper">
            <div class="collapsible-header" onclick="toggleSection('motherboard-products-container', this)">
                <h2>اللوحات الأم (Motherboards)</h2>
                <i class="fas fa-chevron-down text-xl"></i>
            </div>
            <div id="motherboard-products-container" class="collapsible-content">
                <div class="filter-section">
                    <label for="motherboard-min-price">الحد الأدنى للسعر:</label>
                    <input type="number" id="motherboard-min-price" placeholder="مثال: 1000">
                    <label for="motherboard-max-price">الحد الأقصى للسعر:</label>
                    <input type="number" id="motherboard-max-price" placeholder="مثال: 10000">
                    <button onclick="filterProductsBySection('motherboard')">تصفية</button>
                </div>
                <div id="motherboard-products" class="product-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    </div>
            </div>
        </div>

        <div class="collapsible-wrapper">
            <div class="collapsible-header" onclick="toggleSection('ram-products-container', this)">
                <h2>الذاكرة العشوائية (RAM)</h2>
                <i class="fas fa-chevron-down text-xl"></i>
            </div>
            <div id="ram-products-container" class="collapsible-content">
                <div class="filter-section">
                    <label for="ram-min-price">الحد الأدنى للسعر:</label>
                    <input type="number" id="ram-min-price" placeholder="مثال: 1000">
                    <label for="ram-max-price">الحد الأقصى للسعر:</label>
                    <input type="number" id="ram-max-price" placeholder="مثال: 10000">
                    <button onclick="filterProductsBySection('ram')">تصفية</button>
                </div>
                <div id="ram-products" class="product-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    </div>
            </div>
        </div>

        <div class="collapsible-wrapper">
            <div class="collapsible-header" onclick="toggleSection('monitor-products-container', this)">
                <h2>الشاشات (Monitors)</h2>
                <i class="fas fa-chevron-down text-xl"></i>
            </div>
            <div id="monitor-products-container" class="collapsible-content">
                <div class="filter-section">
                    <label for="monitor-min-price">الحد الأدنى للسعر:</label>
                    <input type="number" id="monitor-min-price" placeholder="مثال: 1000">
                    <label for="monitor-max-price">الحد الأقصى للسعر:</label>
                    <input type="number" id="monitor-max-price" placeholder="مثال: 10000">
                    <button onclick="filterProductsBySection('monitor')">تصفية</button>
                </div>
                <div id="monitor-products" class="product-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    </div>
            </div>
        </div>

        <div class="collapsible-wrapper">
            <div class="collapsible-header" onclick="toggleSection('cooler-products-container', this)">
                <h2>مبردات المعالج (Coolers)</h2>
                <i class="fas fa-chevron-down text-xl"></i>
            </div>
            <div id="cooler-products-container" class="collapsible-content">
                <div class="filter-section">
                    <label for="cooler-min-price">الحد الأدنى للسعر:</label>
                    <input type="number" id="cooler-min-price" placeholder="مثال: 1000">
                    <label for="cooler-max-price">الحد الأقصى للسعر:</label>
                    <input type="number" id="cooler-max-price" placeholder="مثال: 10000">
                    <button onclick="filterProductsBySection('cooler')">تصفية</button>
                </div>
                <div id="cooler-products" class="product-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    </div>
            </div>
        </div>

        <div class="collapsible-wrapper">
            <div class="collapsible-header" onclick="toggleSection('keyboard-products-container', this)">
                <h2>لوحات المفاتيح (Keyboards)</h2>
                <i class="fas fa-chevron-down text-xl"></i>
            </div>
            <div id="keyboard-products-container" class="collapsible-content">
                <div class="filter-section">
                    <label for="keyboard-min-price">الحد الأدنى للسعر:</label>
                    <input type="number" id="keyboard-min-price" placeholder="مثال: 1000">
                    <label for="keyboard-max-price">الحد الأقصى للسعر:</label>
                    <input type="number" id="keyboard-max-price" placeholder="مثال: 10000">
                    <button onclick="filterProductsBySection('keyboard')">تصفية</button>
                </div>
                <div id="keyboard-products" class="product-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    </div>
            </div>
        </div>

        <div class="collapsible-wrapper">
            <div class="collapsible-header" onclick="toggleSection('mouse-products-container', this)">
                <h2>الماوسات (Mice)</h2>
                <i class="fas fa-chevron-down text-xl"></i>
            </div>
            <div id="mouse-products-container" class="collapsible-content">
                <div class="filter-section">
                    <label for="mouse-min-price">الحد الأدنى للسعر:</label>
                    <input type="number" id="mouse-min-price" placeholder="مثال: 1000">
                    <label for="mouse-max-price">الحد الأقصى للسعر:</label>
                    <input type="number" id="mouse-max-price" placeholder="مثال: 10000">
                    <button onclick="filterProductsBySection('mouse')">تصفية</button>
                </div>
                <div id="mouse-products" class="product-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    </div>
            </div>
        </div>
    </section>

    <section id="request-build" class="py-12 px-4 text-center hidden">
        <h2 class="text-3xl font-bold mb-6 text-gray-800 dark:text-gray-100">طلب تجميعة مخصصة</h2>
        <p class="text-lg text-gray-600 dark:text-gray-300">
            هذا القسم سيكون مخصصًا لطلب التجميعات المخصصة.
            <br>
            سيتم توفير نموذج لملء تفضيلاتك وميزانيتك هنا قريباً.
        </p>
    </section>

    <section id="favorites-section" class="py-12 px-4 text-center hidden">
        <h2 class="text-3xl font-bold mb-6 text-gray-800 dark:text-gray-100">منتجاتك المفضلة</h2>
        <div id="favorites-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <p class="text-lg text-gray-600 dark:text-gray-300 col-span-full">لا توجد منتجات في المفضلة حالياً.</p>
        </div>
    </section>

    <script>// --- Product Data (Same as your provided data) ---
        const gpuProducts = [
            {
                name: "NVIDIA GeForce RTX 4090",
                image: "https://via.placeholder.com/150",
                price: 75000,
                details: "أقوى كرت شاشة للأداء المطلق في الألعاب بدقة 4K وتقنيات تتبع الأشعة.",
                chipset: "AD102",
                vram: "24GB GDDR6X",
                rating: 5,
            },
            {
                name: "AMD Radeon RX 7900 XTX",
                image: "https://via.placeholder.com/150",
                price: 55000,
                details: "أداء ممتاز في الألعاب بدقة 4K ومنافس قوي في فئته السعرية.",
                chipset: "Navi 31",
                vram: "24GB GDDR6",
                rating: 4,
            },
            {
                name: "NVIDIA GeForce RTX 4070 Ti SUPER",
                image: "https://via.placeholder.com/150",
                price: 35000,
                details: "أداء قوي جداً للألعاب بدقة 1440p و 4K بأسعار تنافسية.",
                chipset: "AD103",
                vram: "16GB GDDR6X",
                rating: 4,
            },
            {
                name: "NVIDIA GeForce RTX 4060",
                image: "https://via.placeholder.com/150",
                price: 15000,
                details: "خيار ممتاز للألعاب بدقة 1080p مع دعم DLSS 3.",
                chipset: "AD107",
                vram: "8GB GDDR6",
                rating: 3,
            },
            {
                name: "AMD Radeon RX 6600 XT",
                image: "https://via.placeholder.com/150",
                price: 10000,
                details: "أداء جيد للألعاب بدقة 1080p بميزانية محدودة.",
                chipset: "Navi 23",
                vram: "8GB GDDR6",
                rating: 3,
            },
        ];

        const processorProducts = [
            {
                name: "Intel Core i9-14900K",
                image: "https://via.placeholder.com/150",
                price: 25000,
                details: "أقوى معالج للألعاب وإنشاء المحتوى، أداء فائق.",
                coreCount: 24,
                threadCount: 32,
                baseFreq: "3.2 GHz",
                boostFreq: "6.0 GHz",
                rating: 5,
            },
            {
                name: "AMD Ryzen 9 7950X3D",
                image: "https://via.placeholder.com/150",
                price: 22000,
                details: "أفضل معالج للألعاب بفضل تقنية 3D V-Cache.",
                coreCount: 16,
                threadCount: 32,
                baseFreq: "4.2 GHz",
                boostFreq: "5.7 GHz",
                rating: 5,
            },
            {
                name: "Intel Core i7-14700K",
                image: "https://via.placeholder.com/150",
                price: 18000,
                details: "معالج قوي للألعاب والمهام المتعددة، قيمة ممتازة.",
                coreCount: 20,
                threadCount: 28,
                baseFreq: "3.4 GHz",
                boostFreq: "5.5 GHz",
                rating: 4,
            },
            {
                name: "AMD Ryzen 7 7800X3D",
                image: "https://via.placeholder.com/150",
                price: 15000,
                details: "المعالج الأفضل للألعاب من حيث السعر والأداء.",
                coreCount: 8,
                threadCount: 16,
                baseFreq: "4.2 GHz",
                boostFreq: "5.0 GHz",
                rating: 5,
            },
            {
                name: "Intel Core i5-13600K",
                image: "https://via.placeholder.com/150",
                price: 12000,
                details: "معالج متوسط المدى يقدم أداءً ممتازاً للألعاب.",
                coreCount: 14,
                threadCount: 20,
                baseFreq: "3.5 GHz",
                boostFreq: "5.1 GHz",
                rating: 4,
            },
        ];

        const motherboardProducts = [
            {
                name: "ASUS ROG Maximus Z790 Hero",
                image: "https://via.placeholder.com/150",
                price: 10000,
                details: "لوحة أم فاخرة لمعالجات إنتل، تدعم أحدث التقنيات.",
                chipset: "Intel Z790",
                rating: 5,
            },
            {
                name: "MSI MAG B650 Tomahawk WiFi",
                image: "https://via.placeholder.com/150",
                price: 6000,
                details: "لوحة أم ممتازة لمعالجات AMD Ryzen، قيمة وسعر.",
                chipset: "AMD B650",
                rating: 4,
            },
            {
                name: "Gigabyte AORUS Master Z790",
                image: "https://via.placeholder.com/150",
                price: 9000,
                details: "لوحة أم قوية لإنتل، تصميم وجودة عالية.",
                chipset: "Intel Z790",
                rating: 4,
            },
            {
                name: "ASRock B650M PG Riptide",
                image: "https://via.placeholder.com/150",
                price: 4500,
                details: "خيار اقتصادي جيد لمعالجات AMD.",
                chipset: "AMD B650",
                rating: 3,
            },
            {
                name: "ASUS Prime H610M-A D4",
                image: "https://via.placeholder.com/150",
                price: 2500,
                details: "لوحة أم أساسية لمعالجات إنتل للميزانيات المحدودة.",
                chipset: "Intel H610",
                rating: 3,
            },
        ];

        const ramProducts = [
            {
                name: "G.Skill Trident Z5 RGB 32GB (2x16GB) DDR5 6400MHz",
                image: "https://via.placeholder.com/150",
                price: 4000,
                details: "ذاكرة DDR5 عالية الأداء مع إضاءة RGB.",
                capacity: "32GB",
                speed: "6400MHz",
                timings: "CL32",
                rating: 5,
            },
            {
                name: "Corsair Vengeance RGB Pro 32GB (2x16GB) DDR4 3600MHz",
                image: "https://via.placeholder.com/150",
                price: 2500,
                details: "ذاكرة DDR4 موثوقة وعالية السرعة مع RGB.",
                capacity: "32GB",
                speed: "3600MHz",
                timings: "CL18",
                rating: 4,
            },
            {
                name: "Kingston Fury Beast 16GB (2x8GB) DDR4 3200MHz",
                image: "https://via.placeholder.com/150",
                price: 1500,
                details: "خيار ممتاز للألعاب المتوسطة، أداء جيد بسعر مناسب.",
                capacity: "16GB",
                speed: "3200MHz",
                timings: "CL16",
                rating: 4,
            },
            {
                name: "Crucial Pro 32GB (2x16GB) DDR5 5600MHz",
                image: "https://via.placeholder.com/150",
                price: 3500,
                details: "ذاكرة DDR5 موثوقة وعملية للاستخدام اليومي والألعاب.",
                capacity: "32GB",
                speed: "5600MHz",
                timings: "CL46",
                rating: 4,
            },
            {
                name: "Teamgroup T-Force Vulcan Z 8GB (1x8GB) DDR4 3000MHz",
                image: "https://via.placeholder.com/150",
                price: 700,
                details: "ذاكرة أساسية للميزانيات المحدودة.",
                capacity: "8GB",
                speed: "3000MHz",
                timings: "CL16",
                rating: 3,
            },
        ];

        const monitorProducts = [
            {
                name: "LG 27GP950-B UltraGear 4K Gaming Monitor",
                image: "https://via.placeholder.com/150",
                price: 8000,
                details: "شاشة ألعاب 4K مع معدل تحديث عالي ووقت استجابة سريع.",
                size: "27 inch",
                resolution: "3840x2160",
                refreshRate: "144Hz",
                rating: 5,
            },
            {
                name: "Samsung Odyssey G7 27 inch Curved Gaming Monitor",
                image: "https://via.placeholder.com/150",
                price: 6000,
                details: "شاشة منحنية سريعة جدًا لتجربة ألعاب غامرة.",
                size: "27 inch",
                resolution: "2560x1440",
                refreshRate: "240Hz",
                rating: 5,
            },
            {
                name: "Dell S2721DGF 27 inch IPS Gaming Monitor",
                image: "https://via.placeholder.com/150",
                price: 4500,
                details: "شاشة 1440p ممتازة للألعاب والاستخدام العام.",
                size: "27 inch",
                resolution: "2560x1440",
                refreshRate: "165Hz",
                rating: 4,
            },
            {
                name: "Acer Nitro XV240Y 23.8 inch IPS Gaming Monitor",
                image: "https://via.placeholder.com/150",
                price: 2500,
                details: "شاشة 1080p بمعدل تحديث عالي ومناسبة للميزانية.",
                size: "23.8 inch",
                resolution: "1920x1080",
                refreshRate: "144Hz",
                rating: 4,
            },
            {
                name: "BenQ MOBIUZ EX3415R Curved Ultrawide",
                image: "https://via.placeholder.com/150",
                price: 9000,
                details: "شاشة عريضة منحنية لتجربة ألعاب وسائط متعددة ممتازة.",
                size: "34 inch",
                resolution: "3440x1440",
                refreshRate: "144Hz",
                rating: 5,
            },
        ];

        const coolerProducts = [
            {
                name: "NZXT Kraken Z73 RGB 360mm AIO Liquid Cooler",
                image: "https://via.placeholder.com/150",
                price: 4500,
                details: "مبرد سائل AIO ممتاز مع شاشة LCD قابلة للتخصيص.",
                type: "Liquid",
                fans: "3x 120mm",
                noise: "22-38 dBA",
                rating: 5,
            },
            {
                name: "Noctua NH-D15 Chromax.Black Air Cooler",
                image: "https://via.placeholder.com/150",
                price: 3000,
                details: "أحد أفضل المبردات الهوائية أداءً وهدوءًا.",
                type: "Air",
                fans: "2x 140mm",
                noise: "19-24.6 dBA",
                rating: 5,
            },
            {
                name: "Cooler Master Hyper 212 Black Edition",
                image: "https://via.placeholder.com/150",
                price: 1000,
                details: "مبرد هوائي اقتصادي لكنه فعال لمعظم المعالجات.",
                type: "Air",
                fans: "1x 120mm",
                noise: "8-27 dBA",
                rating: 3,
            },
            {
                name: "Arctic Liquid Freezer II 240mm AIO",
                image: "https://via.placeholder.com/150",
                price: 2500,
                details: "مبرد سائل AIO بأداء ممتاز وقيمة رائعة.",
                type: "Liquid",
                fans: "2x 120mm",
                noise: "0.3 Sone (max)",
                rating: 4,
            },
            {
                name: "be quiet! Dark Rock Pro 4",
                image: "https://via.placeholder.com/150",
                price: 2800,
                details: "مبرد هوائي قوي وهادئ للغاية.",
                type: "Air",
                fans: "1x 135mm, 1x 120mm",
                noise: "12.8-24.3 dBA",
                rating: 4,
            },
        ];

        const keyboardProducts = [
            {
                name: "Corsair K100 RGB Mechanical Gaming Keyboard",
                image: "https://via.placeholder.com/150",
                price: 3000,
                details: "لوحة مفاتيح ميكانيكية فاخرة مع مفاتيح Cherry MX Speed.",
                keysType: "Mechanical",
                switches: "Cherry MX Speed RGB",
                connection: "Wired",
                rating: 5,
            },
            {
                name: "Razer BlackWidow V3 Pro Wireless Mechanical Keyboard",
                image: "https://via.placeholder.com/150",
                price: 2500,
                details: "لوحة مفاتيح ميكانيكية لاسلكية مع مفاتيح Razer Green.",
                keysType: "Mechanical",
                switches: "Razer Green",
                connection: "Wireless",
                rating: 4,
            },
            {
                name: "Logitech G213 Prodigy Gaming Keyboard",
                image: "https://via.placeholder.com/150",
                price: 700,
                details: "لوحة مفاتيح غشائية للألعاب مع إضاءة RGB.",
                keysType: "Membrane",
                switches: "Rubber Dome",
                connection: "Wired",
                rating: 3,
            },
            {
                name: "HyperX Alloy Origins Core Mechanical Keyboard",
                image: "https://via.placeholder.com/150",
                price: 1500,
                details: "لوحة مفاتيح ميكانيكية مدمجة وممتازة.",
                keysType: "Mechanical",
                switches: "HyperX Red",
                connection: "Wired",
                rating: 4,
            },
            {
                name: "SteelSeries Apex Pro Mini Wireless",
                image: "https://via.placeholder.com/150",
                price: 2800,
                details: "لوحة مفاتيح صغيرة ميكانيكية لاسلكية مع مفاتيح OmniPoint.",
                keysType: "Mechanical (Optical)",
                switches: "OmniPoint 2.0 Adjustable",
                connection: "Wireless",
                rating: 5,
            },
        ];

        const mouseProducts = [
            {
                name: "Logitech G Pro X Superlight Wireless Gaming Mouse",
                image: "https://via.placeholder.com/150",
                price: 2000,
                details: "ماوس ألعاب لاسلكي خفيف الوزن ودقيق للغاية.",
                weight: "63g",
                sensor: "HERO 25K",
                connection: "Wireless",
                battery: "70 hours",
                rating: 5,
            },
            {
                name: "Razer DeathAdder V3 Pro Wireless Gaming Mouse",
                image: "https://via.placeholder.com/150",
                price: 1800,
                details: "ماوس ألعاب لاسلكي مريح وعالي الأداء.",
                weight: "64g",
                sensor: "Focus Pro 30K",
                connection: "Wireless",
                battery: "90 hours",
                rating: 5,
            },
            {
                name: "Glorious Model O Gaming Mouse",
                image: "https://via.placeholder.com/150",
                price: 800,
                details: "ماوس خفيف الوزن بتصميم مميز وأداء جيد.",
                weight: "67g",
                sensor: "Pixart PMW3360",
                connection: "Wired",
                rating: 4,
            },
            {
                name: "SteelSeries Aerox 3 Wireless Gaming Mouse",
                image: "https://via.placeholder.com/150",
                price: 1200,
                details: "ماوس لاسلكي خفيف ومقاوم للماء والغبار.",
                weight: "68g",
                sensor: "TrueMove Air",
                connection: "Wireless",
                battery: "200 hours",
                rating: 4,
            },
            {
                name: "Corsair Scimitar RGB Elite MMO Gaming Mouse",
                image: "https://via.placeholder.com/150",
                price: 1500,
                details: "ماوس مخصص لألعاب MMO مع أزرار جانبية قابلة للبرمجة.",
                weight: "122g",
                sensor: "PMW3391",
                connection: "Wired",
                rating: 4,
            },
        ];

        // Combine all products into one array for overall search
        const allProducts = [
            ...gpuProducts,
            ...processorProducts,
            ...motherboardProducts,
            ...ramProducts,
            ...monitorProducts,
            ...coolerProducts,
            ...keyboardProducts,
            ...mouseProducts,
        ];

        // FAQ Answers (for "Ask Me" feature)
        const faqAnswers = [
            { question: "ما هو أفضل كرت شاشة للألعاب؟", answer: "يعتمد أفضل كرت شاشة على ميزانيتك ودقة الشاشة التي تستخدمها. حاليًا، NVIDIA RTX 4090 هو الأقوى بشكل عام، و AMD RX 7900 XTX منافس قوي. للألعاب بدقة 1440p، يعتبر RTX 4070 Ti SUPER أو RX 7800 XT خيارات ممتازة." },
            { question: "كيف أختار المعالج المناسب؟", answer: "لاختيار المعالج، فكر في استخدامك الأساسي (ألعاب، عمل، تصميم). المعالجات التي تنتهي بحرف 'K' من Intel أو 'X' من AMD قابلة لكسر السرعة. معالجات X3D من AMD ممتازة للألعاب تحديدًا. تأكد من توافقه مع اللوحة الأم." },
            { question: "ما الفرق بين DDR4 و DDR5 RAM؟", answer: "DDR5 هي الجيل الأحدث من الذاكرة العشوائية، وتقدم سرعات أعلى وكفاءة طاقة أفضل من DDR4. تتطلب لوحات أم حديثة تدعم DDR5. إذا كانت ميزانيتك تسمح، DDR5 هي الأفضل للمستقبل." },
            { question: "هل أحتاج مبرد سائل (AIO) أم هوائي؟", answer: "المبردات السائلة غالبًا ما تكون أكثر كفاءة في التبريد للمعالجات عالية الأداء، وتوفر جمالية أفضل. المبردات الهوائية ممتازة وموثوقة وأكثر اقتصادية، وبعضها يقدم أداءً قريبًا من السوائل. يعتمد الاختيار على معالجك وميزانيتك وتفضيلاتك الجمالية." },
            { question: "ما هي أهم مواصفات الشاشة للألعاب؟", answer: "أهم المواصفات هي معدل التحديث (Hz) للحركة السلسة (144Hz فأعلى مثالي)، ووقت الاستجابة (ms) لتقليل الغباش (1ms مثالي)، والدقة (1080p, 1440p, 4K)، ونوع اللوحة (IPS لألوان أفضل، TN لوقت استجابة أسرع)." },
            { question: "كيف أنظف جهاز الكمبيوتر الخاص بي؟", answer: "استخدم هواء مضغوط لتنظيف الغبار من المراوح والمكونات. امسح الأسطح بقطعة قماش ناعمة وجافة. تأكد من فصل الجهاز عن الكهرباء قبل البدء. ينصح بتغيير معجون التبريد للمعالج كل فترة." },
            { question: "ما هي الماوسات المخصصة للألعاب؟", answer: "ماوسات الألعاب تتميز بحساسية (DPI) عالية، أزرار قابلة للبرمجة، وتصميم مريح للاستخدام لفترات طويلة. بعضها لاسلكي مع زمن استجابة منخفض، والبعض الآخر سلكي لضمان عدم وجود تأخير." },
            { question: "ماذا تعني أرقام CL في الرام (CL Timings)؟", answer: "CL تعني 'Column Access Strobe Latency' وتشير إلى عدد دورات الساعة التي يستغرقها الرام للاستجابة لطلب من المعالج. كلما كان الرقم أقل، كان أداء الذاكرة أسرع، لكن الأهم هو السرعة الكلية (MHz) للرام وتوافقه مع المعالج واللوحة الأم." },
            { question: "ما هو الـ Ray Tracing في كروت الشاشة؟", answer: "تتبع الأشعة (Ray Tracing) هي تقنية عرض رسوميات تحاكي سلوك الضوء في العالم الحقيقي لإنتاج إضاءة وظلال وانعكاسات أكثر واقعية في الألعاب. تتطلب كروت شاشة قوية لدعمها وتقلل من الأداء." },
            { question: "ما هي أفضل أنواع لوحات المفاتيح للألعاب؟", answer: "لوحات المفاتيح الميكانيكية هي الأفضل للألعاب بسبب دقة وسرعة الاستجابة ومتانة المفاتيح. هناك أنواع مختلفة من السويتشات (مثل Cherry MX Red للألعاب السريعة، Brown للتوازن، Blue للكتابة)." },
            { question: "ما هو الفرق بين Intel و AMD للمعالجات؟", answer: "كلا الشركتين تقدم معالجات قوية. Intel غالبًا ما تكون الأفضل في الأداء أحادي النواة (مهم لبعض الألعاب القديمة). AMD تتفوق غالبًا في المهام متعددة النوى (للمهام الإنتاجية) ومعالجاتها بتقنية 3D V-Cache ممتازة للألعاب. يعتمد الاختيار على ميزانيتك واستخداماتك." },
            { question: "هل أحتاج إلى Power Supply بقدرة عالية؟", answer: "قدرة الباور سبلاي (Power Supply Unit - PSU) تعتمد على استهلاك الطاقة لمكونات جهازك، خاصة كرت الشاشة والمعالج. يجب أن تكون لديك قدرة كافية (ويفضل بزيادة 10-20% عن المطلوب) لضمان الاستقرار وكفاءة التشغيل. يمكنك استخدام حاسبات الباور سبلاي المتاحة عبر الإنترنت لتقدير احتياجاتك." },
        ];


        // --- Helper Functions ---
        function getStarsHtml(rating) {
            let starsHtml = '';
            for (let i = 0; i < 5; i++) {
                if (i < rating) {
                    starsHtml += '<i class="fas fa-star"></i>'; // Filled star
                } else {
                    starsHtml += '<i class="far fa-star"></i>'; // Empty star
                }
            }
            return `<div class="rating text-yellow-400">${starsHtml}</div>`;
        }

        function displayProducts(productsArray, containerId) {
            const container = document.getElementById(containerId);
            if (!container) {
                console.error(`Container with ID "${containerId}" not found.`);
                return;
            }
            container.innerHTML = ''; // Clear previous products

            if (productsArray.length === 0) {
                container.innerHTML = `<p class="col-span-full text-center text-gray-500 dark:text-gray-400">لا توجد منتجات مطابقة.</p>`;
                return;
            }

            productsArray.forEach((product) => {
                const productCard = document.createElement('div');
                productCard.classList.add('product-card');
                productCard.innerHTML = `
                    <img src="${product.image}" alt="${product.name}" class="w-full h-32 object-contain mb-4">
                    <h3 class="product-title">${product.name}</h3>
                    <p class="product-details">${product.details || ''}</p>
                    ${product.chipset ? `<p class="text-sm text-gray-500 dark:text-gray-400">الرقاقة: ${product.chipset}</p>` : ''}
                    ${product.vram ? `<p class="text-sm text-gray-500 dark:text-gray-400">الرام: ${product.vram}</p>` : ''}
                    ${product.coreCount ? `<p class="text-sm text-gray-500 dark:text-gray-400">عدد الأنوية: ${product.coreCount}</p>` : ''}
                    ${product.threadCount ? `<p class="text-sm text-gray-500 dark:text-gray-400">عدد الثريدات: ${product.threadCount}</p>` : ''}
                    ${product.baseFreq ? `<p class="text-sm text-gray-500 dark:text-gray-400">تردد أساسي: ${product.baseFreq}</p>` : ''}
                    ${product.boostFreq ? `<p class="text-sm text-gray-500 dark:text-gray-400">تردد معزز: ${product.boostFreq}</p>` : ''}
                    ${product.capacity ? `<p class="text-sm text-gray-500 dark:text-gray-400">السعة: ${product.capacity}</p>` : ''}
                    ${product.speed ? `<p class="text-sm text-gray-500 dark:text-gray-400">السرعة: ${product.speed}</p>` : ''}
                    ${product.timings ? `<p class="text-sm text-gray-500 dark:text-gray-400">التوقيتات: ${product.timings}</p>` : ''}
                    ${product.size ? `<p class="text-sm text-gray-500 dark:text-gray-400">الحجم: ${product.size}</p>` : ''}
                    ${product.resolution ? `<p class="text-sm text-gray-500 dark:text-gray-400">الدقة: ${product.resolution}</p>` : ''}
                    ${product.refreshRate ? `<p class="text-sm text-gray-500 dark:text-gray-400">معدل التحديث: ${product.refreshRate}</p>` : ''}
                    ${product.type ? `<p class="text-sm text-gray-500 dark:text-gray-400">النوع: ${product.type}</p>` : ''}
                    ${product.fans ? `<p class="text-sm text-gray-500 dark:text-gray-400">المراوح: ${product.fans}</p>` : ''}
                    ${product.noise !== undefined && product.noise !== null ? `<p class="text-sm text-gray-500 dark:text-gray-400">الضوضاء: ${product.noise}</p>` : ''}
                    ${product.keysType ? `<p class="text-sm text-gray-500 dark:text-gray-400">نوع المفاتيح: ${product.keysType}</p>` : ''}
                    ${product.switches ? `<p class="text-sm text-gray-500 dark:text-gray-400">السويتشات: ${product.switches}</p>` : ''}
                    ${product.weight ? `<p class="text-sm text-gray-500 dark:text-gray-400">الوزن: ${product.weight}</p>` : ''}
                    ${product.sensor ? `<p class="text-sm text-gray-500 dark:text-gray-400">المستشعر: ${product.sensor}</p>` : ''}
                    ${product.connection ? `<p class="text-sm text-gray-500 dark:text-gray-400">التوصيل: ${product.connection}</p>` : ''}
                    ${product.battery ? `<p class="text-sm text-gray-500 dark:text-gray-400">البطارية: ${product.battery}</p>` : ''}
                    ${getStarsHtml(product.rating)}
                    <p class="product-price">${product.price.toLocaleString()} جنيه مصري</p>
                    <button class="details-button mt-auto" onclick="addToFavorites('${getCategoryFromContainerId(containerId)}', '${product.name}')">أضف للمفضلة</button>
                `;
                container.appendChild(productCard);
            });
        }

        // Helper to get category name from container ID for addToFavorites
        function getCategoryFromContainerId(containerId) {
            if (containerId.includes('gpu')) return 'gpu';
            if (containerId.includes('processor')) return 'processor';
            if (containerId.includes('motherboard')) return 'motherboard';
            if (containerId.includes('ram')) return 'ram';
            if (containerId.includes('monitor')) return 'monitor';
            if (containerId.includes('cooler')) return 'cooler';
            if (containerId.includes('keyboard')) return 'keyboard';
            if (containerId.includes('mouse')) return 'mouse';
            return 'all'; // Default if not specific
        }

        // --- Product Filtering Logic ---
        function filterProductsBySection(category) {
            let productsArray;
            let minPriceId, maxPriceId, productsContainerId;

            switch (category) {
                case 'gpu':
                    productsArray = gpuProducts;
                    minPriceId = 'gpu-min-price';
                    maxPriceId = 'gpu-max-price';
                    productsContainerId = 'gpu-products';
                    break;
                case 'processor':
                    productsArray = processorProducts;
                    minPriceId = 'processor-min-price';
                    maxPriceId = 'processor-max-price';
                    productsContainerId = 'processor-products';
                    break;
                case 'motherboard':
                    productsArray = motherboardProducts;
                    minPriceId = 'motherboard-min-price';
                    maxPriceId = 'motherboard-max-price';
                    productsContainerId = 'motherboard-products';
                    break;
                case 'ram':
                    productsArray = ramProducts;
                    minPriceId = 'ram-min-price';
                    maxPriceId = 'ram-max-price';
                    productsContainerId = 'ram-products';
                    break;
                case 'monitor':
                    productsArray = monitorProducts;
                    minPriceId = 'monitor-min-price';
                    maxPriceId = 'monitor-max-price';
                    productsContainerId = 'monitor-products';
                    break;
                case 'cooler':
                    productsArray = coolerProducts;
                    minPriceId = 'cooler-min-price';
                    maxPriceId = 'cooler-max-price';
                    productsContainerId = 'cooler-products';
                    break;
                case 'keyboard':
                    productsArray = keyboardProducts;
                    minPriceId = 'keyboard-min-price';
                    maxPriceId = 'keyboard-max-price';
                    productsContainerId = 'keyboard-products';
                    break;
                case 'mouse':
                    productsArray = mouseProducts;
                    minPriceId = 'mouse-min-price';
                    maxPriceId = 'mouse-max-price';
                    productsContainerId = 'mouse-products';
                    break;
                default:
                    console.error("Unknown category for filtering.");
                    return;
            }

            const minPrice = document.getElementById(minPriceId).value;
            const maxPrice = document.getElementById(maxPriceId).value;

            if (!minPrice || !maxPrice) {
                alert("الرجاء إدخال الحد الأدنى والأعلى للسعر."); // Replace with toast notification later
                return;
            }

            const min = parseFloat(minPrice);
            const max = parseFloat(maxPrice);

            if (isNaN(min) || isNaN(max) || min < 0 || max < 0 || min > max) {
                alert("الرجاء إدخال أسعار صحيحة. (يجب أن يكون الحد الأدنى أقل من أو يساوي الحد الأقصى وأن تكون الأرقام إيجابية)");
                return;
            }

            const filteredProducts = productsArray.filter(
                (product) => product.price >= min && product.price <= max
            );

            displayProducts(filteredProducts, productsContainerId);

            // Clear the input fields after filtering
            document.getElementById(minPriceId).value = "";
            document.getElementById(maxPriceId).value = "";
        }

        // The addToFavorites function is kept here, but without a button to call it from the UI.
        function addToFavorites(category, productName) {
            let product;
            switch (category) {
                case "gpu": product = gpuProducts.find((p) => p.name === productName); break;
                case "processor": product = processorProducts.find((p) => p.name === productName); break;
                case "motherboard": product = motherboardProducts.find((p) => p.name === productName); break;
                case "ram": product = ramProducts.find((p) => p.name === productName); break;
                case "monitor": product = monitorProducts.find((p) => p.name === productName); break;
                case "cooler": product = coolerProducts.find((p) => p.name === productName); break;
                case "keyboard": product = keyboardProducts.find((p) => p.name === productName); break;
                case "mouse": product = mouseProducts.find((p) => p.name === productName); break;
                default: product = allProducts.find((p) => p.name === productName); break;
            }

            if (product) {
                let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
                const isProductInFavorites = favorites.some(fav => fav.name === product.name);

                if (!isProductInFavorites) {
                    favorites.push(product);
                    localStorage.setItem('favorites', JSON.stringify(favorites));
                    alert(`${product.name} تمت إضافته إلى مفضلتك!`); // Replace with toast notification
                } else {
                    alert(`${product.name} موجود بالفعل في مفضلتك!`); // Replace with toast notification
                }
            }
        }

        // Modified toggleSection to receive the clicked header element to update its icon
        function toggleSection(containerId, headerElement) {
            const content = document.getElementById(containerId);
            const icon = headerElement ? headerElement.querySelector('i') : null;

            if (content) {
                content.classList.toggle('show');
                if (icon) {
                    if (content.classList.contains('show')) {
                        icon.classList.replace('fa-chevron-down', 'fa-chevron-up');
                    } else {
                        icon.classList.replace('fa-chevron-up', 'fa-chevron-down');
                    }
                }
            }
        }

        // --- Dark/Light Mode Logic ---
        const modeToggle = document.getElementById('mode-toggle');

        function enableDarkMode() {
            document.documentElement.classList.add('dark');
            document.body.classList.add('dark-mode');
            localStorage.setItem('theme', 'dark');
            const icon = modeToggle ? modeToggle.querySelector('i') : null;
            if (icon) {
                icon.classList.replace('fa-sun', 'fa-moon');
            }
        }

        function enableLightMode() {
            document.documentElement.classList.remove('dark');
            document.body.classList.remove('dark-mode');
            localStorage.setItem('theme', 'light');
            const icon = modeToggle ? modeToggle.querySelector('i') : null;
            if (icon) {
                icon.classList.replace('fa-moon', 'fa-sun');
            }
        }

        if (modeToggle) {
            modeToggle.addEventListener('click', () => {
                modeToggle.classList.add('spin');
                setTimeout(() => {
                    modeToggle.classList.remove('spin');
                }, 300);

                if (document.documentElement.classList.contains('dark')) {
                    enableLightMode();
                } else {
                    enableDarkMode();
                }
            });
        }

        // Initialize theme and display products on load
        window.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                enableDarkMode();
            } else {
                enableLightMode();
            }

            // Display initial products for all sections (but keep them collapsed by default)
            displayProducts(gpuProducts, "gpu-products");
            displayProducts(processorProducts, "processor-products");
            displayProducts(motherboardProducts, "motherboard-products");
            displayProducts(ramProducts, "ram-products");
            displayProducts(monitorProducts, "monitor-products");
            displayProducts(coolerProducts, "cooler-products");
            displayProducts(keyboardProducts, "keyboard-products");
            displayProducts(mouseProducts, "mouse-products");

            // No section is expanded by default now as per new requirement.
            // The previous code to expand GPU section is removed.
        });

        // --- Product Search Logic ---
        function searchProducts() {
            const searchInput = document.getElementById('product-search-input').value.toLowerCase();
            const allProductContainers = {
                'gpu-products': gpuProducts,
                'processor-products': processorProducts,
                'motherboard-products': motherboardProducts,
                'ram-products': ramProducts,
                'monitor-products': monitorProducts,
                'cooler-products': coolerProducts,
                'keyboard-products': keyboardProducts,
                'mouse-products': mouseProducts
            };

            // Clear previous search results and collapse sections
            for (const categoryId in allProductContainers) {
                const container = document.getElementById(`${categoryId}-container`);
                const header = container ? container.previousElementSibling : null;
                const icon = header ? header.querySelector('i') : null;

                if (container && container.classList.contains('show')) {
                    container.classList.remove('show');
                    if (icon) {
                        icon.classList.replace('fa-chevron-up', 'fa-chevron-down');
                    }
                }
                const gridContainer = document.querySelector(`#${categoryId}`); // Corrected to target grid div directly
                if (gridContainer) {
                    gridContainer.innerHTML = '';
                }
            }

            if (searchInput === '') {
                // If search input is empty, re-display all products as they were initially (collapsed by default)
                displayProducts(gpuProducts, "gpu-products");
                displayProducts(processorProducts, "processor-products");
                displayProducts(motherboardProducts, "motherboard-products");
                displayProducts(ramProducts, "ram-products");
                displayProducts(monitorProducts, "monitor-products");
                displayProducts(coolerProducts, "cooler-products");
                displayProducts(keyboardProducts, "keyboard-products");
                displayProducts(mouseProducts, "mouse-products");
                return;
            }

            let productsFoundInAnyCategory = false;
            for (const categoryId in allProductContainers) {
                const products = allProductContainers[categoryId];
                const filteredProducts = products.filter(product =>
                    product.name.toLowerCase().includes(searchInput) ||
                    (product.details && product.details.toLowerCase().includes(searchInput)) ||
                    (product.chipset && product.chipset.toLowerCase().includes(searchInput)) ||
                    (product.vram && product.vram.toLowerCase().includes(searchInput)) ||
                    (product.size && product.size.toLowerCase().includes(searchInput)) ||
                    (product.resolution && product.resolution.toLowerCase().includes(searchInput)) ||
                    (product.refreshRate && product.refreshRate.toLowerCase().includes(searchInput)) ||
                    (product.type && product.type.toLowerCase().includes(searchInput)) ||
                    (product.fans && product.fans.toLowerCase().includes(searchInput)) ||
                    (product.noise !== undefined && product.noise !== null && product.noise.toString().toLowerCase().includes(searchInput)) ||
                    (product.keysType && product.keysType.toLowerCase().includes(searchInput)) ||
                    (product.switches && product.switches.toLowerCase().includes(searchInput)) ||
                    (product.coreCount && product.coreCount.toString().includes(searchInput)) ||
                    (product.threadCount && product.threadCount.toString().includes(searchInput)) ||
                    (product.baseFreq && product.baseFreq.toLowerCase().includes(searchInput)) ||
                    (product.boostFreq && product.boostFreq.toLowerCase().includes(searchInput)) ||
                    (product.weight && product.weight.toLowerCase().includes(searchInput)) ||
                    (product.sensor && product.sensor.toLowerCase().includes(searchInput)) ||
                    (product.connection && product.connection.toLowerCase().includes(searchInput)) ||
                    (product.battery && product.battery.toLowerCase().includes(searchInput)) ||
                    (product.capacity && product.capacity.toLowerCase().includes(searchInput)) ||
                    (product.speed && product.speed.toLowerCase().includes(searchInput)) ||
                    (product.timings && product.timings.toLowerCase().includes(searchInput))
                );

                if (filteredProducts.length > 0) {
                    displayProducts(filteredProducts, categoryId);
                    const container = document.getElementById(`${categoryId}-container`);
                    const header = container ? container.previousElementSibling : null;
                    if (container && header && !container.classList.contains('show')) {
                        toggleSection(categoryId + '-container', header); // Use toggleSection to expand
                    }
                    productsFoundInAnyCategory = true;
                } else {
                    const container = document.querySelector(`#${categoryId}`); // Corrected to target grid div directly
                    if (container) {
                        container.innerHTML = `<p class="col-span-full text-center text-gray-500 dark:text-gray-400">لا توجد منتجات مطابقة في هذا القسم.</p>`;
                    }
                }
            }
            if (!productsFoundInAnyCategory && searchInput !== '') {
                // Optionally display a global "no results" message if no products found anywhere
                // This part is currently handled by each section, but could be centralized if needed.
            }
        }

        // --- Ask Me Feature Logic ---
        function submitQuestion() {
            const questionInput = document.getElementById('ask-me-input');
            const answerDiv = document.getElementById('ask-me-answer');
            const userQuestion = questionInput.value.trim();

            if (userQuestion === "") {
                answerDiv.textContent = "الرجاء كتابة سؤالك.";
                answerDiv.classList.remove('hidden');
                return;
            }

            const matchedFaq = faqAnswers.find(faq =>
                faq.question.toLowerCase().includes(userQuestion.toLowerCase()) ||
                userQuestion.toLowerCase().includes(faq.question.toLowerCase())
            );

            if (matchedFaq) {
                answerDiv.innerHTML = `<strong>سؤالك:</strong> ${userQuestion}<br><strong>الإجابة:</strong> ${matchedFaq.answer}`;
                answerDiv.classList.remove('hidden');
            } else {
                answerDiv.textContent = "عذراً، لم أجد إجابة محددة لسؤالك. يرجى إعادة الصياغة أو تصفح قسم الأسئلة الشائعة (إذا كان متوفراً).";
                answerDiv.classList.remove('hidden');
            }
            questionInput.value = "";
        }
    </script>
</body>
</html>
